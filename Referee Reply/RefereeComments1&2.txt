Reviewer: 1

Comments to the Author
The focus of this paper is the problem of causal inference, which is to investigate whether it is possible that a given distribution have been generated by a hypothesized causal structure. The authors introduce the inflation technique for casual inference. In this approach for a given causal structure, one first constructs an inflation of the given structure, which has duplications of one or more nodes of the original structure while mirroring the ancestors of the nodes and parameters. One can use this inflates structure, to check incompatibility of a given distribution with the original causal structure, as well as obtaining necessary conditions for compatibility of a given distribution with the original causal structure. 
In general, the problem is of great importance, and the results are interesting. Just the ease of obtaining expressions such as (33) and (41) from the proposed approach shows the power of this technique. The paper is very well written, easy to understand, and very well organized. 

I only have some minor concerns on the following issues: 

(1) In the definition of compatibility the requirement is that the distribution contains independence relations of the structure and the distribution can contain much more conditional relations. In other words, faithfulness of the distribution is never considered. This can extremely restrict the usefulness of the defined compatibility in algorithmic structure learning. For example, on page 3, it is said that: “The DAGs that are compatible with the given distribution can be determined algorithmically”. This is in general seems to be not true and faithfulness is required too. Some comments from the authors in this regard would be appreciated.

(2) In the definition of inflation, Definition 2, G’ can have significantly less nodes than G, while in the rest of the paper, it seems that it is always useful that the inflated structure has at least one copy of each variable in G. Was there a reason for this specific definition of inflation.

(3) In equation (6)-(9), it seems that U~U’ is redundant.

(4) In several places it is mentioned that the inflation technique applies just as well in the case of continuous variables. This is true for the general idea, e.g., by using information theoretic inequalities as presented in one of the examples, but for the general approach provided in Section IV, it is not clear.

(5) An important missing parts in this work is to provide a clear method or at least some rigorous ideas for choosing a good inflated structure. This could be very problematic as a given structure can have infinitely many inflations.

(6) There is an inconstancy between expressions in (42) and (43) because the former indicates pairwise independence and the latter indicates jointly independence. The authors should clarify which one is of interest.

(7) In the definition of ancestral independence on page 13, one node should not be an ancestor of the other either. This is reflected in (29), by the definition of An(.) but it seems that it is not correctly described in the text. Also, from the definition of ancestral independence, it is not clear how the conditional case, mentioned below (29) is defined (e.g., does S need to be a subset of common ancestors, etc.). It seems that in that part the authors just considered the original notion of d-separation. 

(8) As the authors have mentioned in Section IV-A, the conditions obtained in the proposed method are implied by ancestral independences among the observed variables of the causal structure. It seems that this is in fact the main focus of the work, both for the way inflated structure is defined and the way necessary conditions are obtained. It would be good if the authors explain the use of this idea as one of the main tools used in the proposed technique in the beginning of the paper.

(9) At the beginning of Section III-C, it would be helpful that the authors clarify what other types of conditions, besides inequalities, could have been considered as necessary conditions for compatibility.

(10) In Definition 7, the intuition behind rule 1 is not clear. Also, considering the definition of expressibility as “the joint distribution can be expressed as a function of distributions over injectable sets”, it is not clear why only these two rules are enough for checking expressibility. Also, rules 1 and 2 could have been presented as a method to check expressibility not as the definition.

(11) In the proposed method, we restrict ourselves to a.i. expressible sets. But it is not clear how much we are loosing by doing so. It would be helpful that at least for one example the general independence (as explained in Section V-A) be considered and the authors explain what we are missing.

(12) The sentence “one rather determines all constraints that such a family must satisfy in order to arise from a joint distribution” on page 17 is vague and requires more elaboration.

(13) Lemma 4 is the main basis of this work, hence (even though from reasonings such as the one below expression (6) it seems correct), it is better that a formal proof for this lemma be presented in the paper.

(14) The explanations in section IV-B are not quite clear and need improvement. It would be very helpful if the example in appendix B is brought in the main text.

Reviewer: 2

Comments to the Author
In this paper the authors provide a novel way to solve the following causal inference problem: to test whether a given a test probability distribution is compatible with a given causal structure containing latent variables. This is an important and yet very difficult problem for which some general purpose algorithms (using algebraic geometry) are known (in the case of variables with finite cardinality) but that in practice have very limited application.

The solution proposed by the authors, the so called inflation, is to consider an extended version of the causal structure where some nodes are duplicated (keeping their graph-ancestrality). They show that any necessary conditions characterizing the inflated graph will also hold for the original one. The nice property of this construction is that linear (and thus simpler) constraints on the inflated graph lead to non-linear constraints on the original one. The paper also has a more exploratory section (the section V) with nice ideas for future work.

Overall the paper is well written and structured. A nice feature is the fact that it contains lots of examples of the general (and abstract) method, making it easily accessible to the interested reader. The method proposed is certainly novel and opens a new venue for the characterization of causal structures out of reach of other current approaches. The paper certainly should be published and fits very well the scope of JCI. My only concern/criticism is the fact that the discussion is very geared towards the quantum community. It would be nice to see their method applied to some causal structure of relevance to the "classical community" in causal inference (I guess the triangle scenario could have some applications in classical causal inference but something more specific would be better). However, I recommend publication independently of that.

In summary, this paper contains a novel method of general applicability for a central (and very difficult) question in causal inference. I believe it has the potential to become a standard tool at least in problems connected with quantum foundations/Bell's theorem. I strongly support its publication in JCI.



1) There is some problem with the latex in the contents section (the numbering is overlapping with the text)

2) At least in the pdf version I had access I had no bibliography. Because of that I cannot judge if the bibliography is adequate or not.

3) In page 2 it is said "Causal inference problems arise in a wide variety of scientific disciplines, from sussing out biological pathways to enabling machine learning." I have already seen machine learning applied to causal inference but not the other way around. What the authors mean with the statement that causal inference enables machine learning?

4) In page 3 the authors divide the problem in 2 varieties: latent variables with or without bounded cardinality. What about observable variables with unbounded cardinalities? It is not clear from the discussion in this part of the paper whether the inflation method will also apply/be useful in such cases. Could the author please clarify that?

5) The authors say also in page 3  "Later work, by Clauser, Horne, Shimony and Holt (CHSH) showed how to derive inequalities directly from the causal structure [17]." Is this really the case? CHSH already had this notion of causal structure? My impression is that they derive their inequality resorting to the usual local realism arguments (that only very implicitly use the notion of a causal structure).

6) In page 4 "Furthermore, the fraction of causal structures that are interesting increases as the total number of nodes increases." I believe that this is the case as well... but, is there any formal proof of this statement? Or is this just some sort of common sense?

7) Example 1, page 9. I believe this result could be easily strengthened and generalized. Consider a scenario with with n observable variables and latent variables that connect at most n-1 of them. Using the appropriate cut inflation it should be easy to prove that perfect correlation between the n variables is not possible with such causal structure. I would guess that the same argument would hold for larger cardinality.

8) In page 14 example 4. In the previous section the authors used the inflation method to test perfect correlations. The inequality (33) could be used also to test imperfect correlations, for example mixing probability (10) with an iid distribution. It would be nice to make this point here and show what is the critical value of this mixing parameter below which the inequality (33) stops to be violated. (One could also compare this with results from other methods).

9) In page 14 example 5. In the case of probabilities or correlators I can clearly see the utility of the inflation method (it kinds of "convexifies" and non-convex problem). However, for entropies (already a linear problem) it seems a bit of useless complication. It would be useful to clarify that at this example. A related question: can the inflation technique give rise to non-Shannon type inequalities (starting from Shannon ones)? The inflation technique seems a bit related to the original proofs of the first non-Shannon type inequalities (extending the space to include new variables and imposing some linear constraints on this extended space). That would be a nice connection.